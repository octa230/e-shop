{"ast":null,"code":"import _asyncToGenerator from\"/home/octa/e-shop/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/octa/e-shop/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"/home/octa/e-shop/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/home/octa/e-shop/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useContext,useEffect,useReducer}from'react';import{Helmet}from'react-helmet-async';import{Link,useNavigate}from'react-router-dom';import{Store}from'../Store';import CheckoutSteps from'../components/CheckoutSteps';import Card from'react-bootstrap/Card';import ListGroup from'react-bootstrap/esm/ListGroup';import Row from'react-bootstrap/esm/Row';import Col from'react-bootstrap/esm/Col';import Button from'react-bootstrap/esm/Button';import{toast}from'react-toastify';import{getError}from'../utils';import axios from'axios';import LoadingBox from'../components/LoadingBox';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var reducer=function reducer(state,action){switch(action.type){case'CREATE_REQUEST':return _objectSpread(_objectSpread({},state),{},{loading:true});case'CREATE_SUCCES':return _objectSpread(_objectSpread({},state),{},{loading:false});case'CREATE_FAIL':return _objectSpread(_objectSpread({},state),{},{loading:false});default:return state;}};export default function PlaceOrderScreen(){var navigate=useNavigate();var _useReducer=useReducer(reducer,{loading:false}),_useReducer2=_slicedToArray(_useReducer,2),loading=_useReducer2[0].loading,dispatch=_useReducer2[1];var _useContext=useContext(Store),state=_useContext.state,ctxDispatch=_useContext.dispatch;var cart=state.cart,userInfo=state.userInfo;var round2=function round2(num){return Math.round(num*100+Number.EPSILON)/100;};//2; ROUNDS NUMBER TO 2 DECIMAL POINTS\ncart.itemsPrice=round2(cart.cartItems.reduce(function(a,c){return a+c.quantity*c.price;},0));cart.shippingPrice=cart.itemsPrice>100?round2(0):round2(10);cart.taxPrice=round2(0.15*cart.itemsPrice);cart.totalPrice=cart.itemsPrice+cart.shippingPrice+cart.taxPrice;var placeOrderHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch({type:'CREATE_REQUEST'});_context.prev=1;dispatch({type:'CREATE_REQUEST'});_context.next=5;return axios.post('/api/orders',{orderItems:cart.cartItems,shippingAddress:cart.shippingAddress,shippingPrice:cart.shippingPrice,paymentMethod:cart.paymentMethod,itemsPrice:cart.itemsPrice,taxPrice:cart.taxPrice,totalPrice:cart.totalPrice},{headers:{authorization:\"Bearer \".concat(userInfo.token)}});case 5:_yield$axios$post=_context.sent;data=_yield$axios$post.data;ctxDispatch({type:'CART_CLEAR'});dispatch({type:'CREATE_SUCCESS'});localStorage.removeItem('cartItems');navigate(\"/order/\".concat(data.order._id));_context.next=17;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](1);dispatch({type:'CREATE_FAIL'});toast.error(getError(_context.t0));case 17:case\"end\":return _context.stop();}}},_callee,null,[[1,13]]);}));return function placeOrderHandler(){return _ref.apply(this,arguments);};}();useEffect(function(){if(!cart.paymentMethod){navigate('/payment');}},[cart,navigate]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CheckoutSteps,{step1:true,step2:true,step3:true,step4:true}),/*#__PURE__*/_jsx(Helmet,{children:/*#__PURE__*/_jsx(\"title\",{children:\"Preview Order\"})}),/*#__PURE__*/_jsx(\"h1\",{className:\"my-3\",children:\"Preview Order\"}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{md:8,children:[/*#__PURE__*/_jsx(Card,{className:\"mb-3\",children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Title,{className:\"card_title\",children:\"Shipping\"}),/*#__PURE__*/_jsxs(Card.Text,{className:\"card_text\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Name:\"}),cart.shippingAddress.fullName,\" \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"Address:\"}),cart.shippingAddress.address,\",\",cart.shippingAddress.city,\", \",cart.shippingAddress.postalCode,\",\",cart.shippingAddress.country]}),/*#__PURE__*/_jsx(Link,{to:\"/shipping\",children:\"Edit\"})]})}),/*#__PURE__*/_jsx(Card,{className:\"mb-3\",children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Title,{className:\"card_title\",children:\"Payment\"}),/*#__PURE__*/_jsxs(Card.Text,{className:\"card_text\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Method: \"}),cart.paymentMethod]}),/*#__PURE__*/_jsx(Link,{to:\"/Payment\",children:\"Edit\"})]})}),/*#__PURE__*/_jsx(Card,{className:\"mb-3\",children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Title,{className:\"card_title\",children:\"Items\"}),/*#__PURE__*/_jsx(ListGroup,{variant:\"flush\",children:cart.cartItems.map(function(item){return/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{className:\"align-items-center\",children:[/*#__PURE__*/_jsxs(Col,{md:6,children:[/*#__PURE__*/_jsx(\"img\",{src:item.image,alt:item.name,className:\"img-fluid rounded img-thumbnail cart_image\"}),/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(item.slug),children:item.name})]}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsx(\"span\",{children:item.quantity})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",item.price]})})]})},item._id);})}),/*#__PURE__*/_jsx(Link,{to:\"/cart\",children:\"Edit\"})]})})]}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Title,{children:\"Order Summary\"}),/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Items\"}),/*#__PURE__*/_jsxs(Col,{children:[\"AED \",cart.itemsPrice.toFixed(2)]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Shipping\"}),/*#__PURE__*/_jsxs(Col,{children:[\"AED \",cart.shippingPrice.toFixed(2)]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Tax\"}),/*#__PURE__*/_jsxs(Col,{children:[\"AED \",cart.taxPrice.toFixed(2)]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Order Total\"}),/*#__PURE__*/_jsxs(Col,{children:[\"AED \",cart.totalPrice.toFixed(2)]})]})}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-grid\",children:/*#__PURE__*/_jsx(Button,{type:\"button\",onClick:placeOrderHandler,disabled:cart.cartItems.length===0,variant:\"dark\",children:\"Place Order\"})}),loading&&/*#__PURE__*/_jsx(LoadingBox,{})]})]})]})})]})]});}","map":{"version":3,"sources":["/home/octa/e-shop/frontend/src/screens/PlaceOrderScreen.js"],"names":["React","useContext","useEffect","useReducer","Helmet","Link","useNavigate","Store","CheckoutSteps","Card","ListGroup","Row","Col","Button","toast","getError","axios","LoadingBox","reducer","state","action","type","loading","PlaceOrderScreen","navigate","dispatch","ctxDispatch","cart","userInfo","round2","num","Math","round","Number","EPSILON","itemsPrice","cartItems","reduce","a","c","quantity","price","shippingPrice","taxPrice","totalPrice","placeOrderHandler","post","orderItems","shippingAddress","paymentMethod","headers","authorization","token","data","localStorage","removeItem","order","_id","error","fullName","address","city","postalCode","country","map","item","image","name","slug","toFixed","length"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useReducer } from 'react'\nimport { Helmet } from 'react-helmet-async'\nimport { Link, useNavigate} from 'react-router-dom'\nimport { Store } from '../Store'\nimport CheckoutSteps from '../components/CheckoutSteps'\nimport Card from 'react-bootstrap/Card'\nimport ListGroup from 'react-bootstrap/esm/ListGroup'\nimport Row from 'react-bootstrap/esm/Row'\nimport Col from 'react-bootstrap/esm/Col'\nimport Button from 'react-bootstrap/esm/Button'\nimport { toast } from 'react-toastify'\nimport { getError } from '../utils'\nimport axios from 'axios'\nimport LoadingBox from '../components/LoadingBox'\n\n\nconst reducer = (state, action) =>{\n    switch(action.type) {\n        case 'CREATE_REQUEST':\n            return {...state, loading: true};\n        case 'CREATE_SUCCES':\n            return{...state, loading: false};\n        case 'CREATE_FAIL':\n                return{...state, loading: false};\n        default:\n            return state;\n    }\n}\n\nexport default function PlaceOrderScreen() {\n\n    const navigate = useNavigate();\n\n    const [{loading }, dispatch] = useReducer(reducer, {\n        loading: false,\n    });\n\n    const { state, dispatch: ctxDispatch } = useContext(Store);\n    const { cart, userInfo} = state;\n\n    const round2 = (num) => Math.round(num * 100 + Number.EPSILON) / 100; //2; ROUNDS NUMBER TO 2 DECIMAL POINTS\n    cart.itemsPrice = round2(\n        cart.cartItems.reduce((a, c) => a + c.quantity * c.price, 0)\n    );\n    cart.shippingPrice =  cart.itemsPrice > 100 ? round2(0) : round2(10);\n    cart.taxPrice = round2(0.15 * cart.itemsPrice);\n    cart.totalPrice = cart.itemsPrice + cart.shippingPrice + cart.taxPrice; \n\n    const placeOrderHandler = async() => {\n        dispatch({type: 'CREATE_REQUEST'});\n\n        try {\n            dispatch({type: 'CREATE_REQUEST' });\n\n        const { data } = await axios.post(\n            '/api/orders',\n            {\n                orderItems:cart.cartItems,\n                shippingAddress: cart.shippingAddress,\n                shippingPrice: cart.shippingPrice,\n                paymentMethod: cart.paymentMethod,\n                itemsPrice: cart.itemsPrice,\n                taxPrice: cart.taxPrice,\n                totalPrice: cart.totalPrice,\n            },\n            {\n                headers: {\n                    authorization: `Bearer ${userInfo.token}`\n                }\n            }\n        );\n\n        ctxDispatch({type: 'CART_CLEAR'});\n        dispatch({type: 'CREATE_SUCCESS'});\n        localStorage.removeItem('cartItems');\n        navigate(`/order/${data.order._id}`);\n\n       } catch (err) {\n           dispatch({type: 'CREATE_FAIL'});\n           toast.error(getError(err));\n           \n       } \n    };\n\n    useEffect(() => {\n        if(!cart.paymentMethod){\n            navigate('/payment');\n        }\n    }, [cart, navigate])\n    \n\n  return (\n    <div>\n      <CheckoutSteps step1 step2 step3 step4></CheckoutSteps>\n      <Helmet>\n          <title>Preview Order</title>\n      </Helmet>\n      <h1 className='my-3'>Preview Order</h1>\n      <Row>\n          <Col md={8}>\n              <Card className='mb-3'>\n                  <Card.Body>\n                      <Card.Title className='card_title'>Shipping</Card.Title>\n                      <Card.Text className='card_text'>\n                      <strong>Name:</strong>{cart.shippingAddress.fullName} <br />\n                        <strong>Address:</strong>{cart.shippingAddress.address},\n                        {cart.shippingAddress.city}, {cart.shippingAddress.postalCode},\n                         {cart.shippingAddress.country}\n                      </Card.Text>\n                      <Link to='/shipping'>Edit</Link>\n                  </Card.Body>\n              </Card>\n              <Card className='mb-3'>\n                  <Card.Body>\n                      <Card.Title className='card_title'>Payment</Card.Title>\n                      <Card.Text className='card_text'>\n                          <strong>Method: </strong>{cart.paymentMethod}\n                      </Card.Text>\n                      <Link to='/Payment'>Edit</Link>\n                  </Card.Body>\n              </Card>\n              <Card className='mb-3'>\n                  <Card.Body>\n                  <Card.Title className='card_title'>Items</Card.Title>\n                  <ListGroup variant='flush'>\n                      {cart.cartItems.map((item) =>(\n                          <ListGroup.Item key={item._id}>\n                              <Row className='align-items-center'>\n                                <Col md={6}>\n                                    <img src={item.image} alt={item.name} \n                                    className='img-fluid rounded img-thumbnail cart_image'></img>\n                                    <Link to={`/product/${item.slug}`}>{item.name}</Link>\n                                </Col>\n                                <Col md={3}><span>{item.quantity}</span></Col>\n                                <Col md={3}><span>${item.price}</span></Col>\n                              </Row>\n                          </ListGroup.Item>\n                      ))}\n                  </ListGroup>\n                  <Link to='/cart'>Edit</Link>\n                  </Card.Body>\n              </Card>\n          </Col>\n          <Col md={4}>\n              <Card.Body>\n                  <Card.Title>Order Summary</Card.Title>\n                  <ListGroup variant='flush'>\n                      <ListGroup.Item>\n                          <Row>\n                              <Col>Items</Col>\n                              <Col>AED {cart.itemsPrice.toFixed(2)}</Col>\n                          </Row>\n                      </ListGroup.Item>\n                      <ListGroup.Item>\n                          <Row>\n                              <Col>Shipping</Col>\n                              <Col>AED {cart.shippingPrice.toFixed(2)}</Col>\n                          </Row>\n                      </ListGroup.Item>\n                      <ListGroup.Item>\n                          <Row>\n                              <Col>Tax</Col>\n                              <Col>AED {cart.taxPrice.toFixed(2)}</Col>\n                          </Row>\n                      </ListGroup.Item>\n                      <ListGroup.Item>\n                          <Row>\n                              <Col>Order Total</Col>\n                              <Col>AED {cart.totalPrice.toFixed(2)}</Col>\n                          </Row>\n                      </ListGroup.Item>\n                      <ListGroup.Item>\n                      <div className='d-grid'>\n                          <Button type='button' onClick={placeOrderHandler} \n                          disabled={cart.cartItems.length === 0} variant='dark'>Place Order</Button>\n                      </div>\n                      {loading && <LoadingBox></LoadingBox>}\n                      </ListGroup.Item>\n                  </ListGroup>\n              </Card.Body>\n          </Col>\n      </Row>\n    </div>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}